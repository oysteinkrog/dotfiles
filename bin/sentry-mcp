#!/bin/bash
# Wrapper that launches the Sentry MCP server with credentials
SECRETS_FILE="$HOME/.config/secrets/.env"
if [ -f "$SECRETS_FILE" ]; then
    while IFS= read -r line; do
        [[ "$line" =~ ^[[:space:]]*(#|$) ]] && continue
        if [[ "$line" =~ ^([A-Za-z_][A-Za-z0-9_]*)=(.*)$ ]]; then
            export "${BASH_REMATCH[1]}=${BASH_REMATCH[2]}"
        fi
    done < "$SECRETS_FILE"
fi
export SENTRY_ACCESS_TOKEN="$SENTRY_AUTH_TOKEN"
exec npx -y @sentry/mcp-server@latest "$@"
