#!/bin/bash
# Wrapper that launches the Zendesk MCP server with credentials
# Uses local forked repo at /c/WORK/zendesk-mcp-server2
# Secrets sourced from fish config (not tracked in dotfiles)
SECRETS_FILE="$HOME/.config/fish/conf.d/secrets.fish"
if [ -f "$SECRETS_FILE" ]; then
    while IFS= read -r line; do
        if [[ "$line" =~ ^set\ -gx\ ([A-Za-z_][A-Za-z0-9_]*)\ \"(.*)\"$ ]]; then
            export "${BASH_REMATCH[1]}=${BASH_REMATCH[2]}"
        fi
    done < "$SECRETS_FILE"
fi
export ZENDESK_EMAIL="$ZENDESK_EMAIL"
export ZENDESK_API_TOKEN="$ZENDESK_API_TOKEN"
export ZENDESK_SUBDOMAIN="$ZENDESK_SUBDOMAIN"
exec node /c/WORK/zendesk-mcp-server2/src/index.js "$@"
