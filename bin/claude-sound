#!/usr/bin/env bash
# claude-sound - Play game sound effects for Claude Code hooks
# Usage: claude-sound <complete|input|error>
# Sounds live in ~/.dotfiles/sounds/claude/

SOUND_DIR="$HOME/.dotfiles/sounds/claude"
SOUND="$SOUND_DIR/${1:-complete}.wav"
PS="/c/Windows/System32/WindowsPowerShell/v1.0/powershell.exe"

[[ -f "$SOUND" ]] || exit 0

win_path=$(wslpath -w "$SOUND" 2>/dev/null)
[[ -z "$win_path" ]] && win_path=$(echo "$SOUND" | sed 's|^/c/|C:\\|;s|/|\\|g')

"$PS" -NoProfile -NonInteractive -Command "
    Add-Type -AssemblyName PresentationCore
    \$p = New-Object System.Windows.Media.MediaPlayer
    \$p.Open([Uri]'$win_path')
    \$p.Play()
    Start-Sleep -Milliseconds 3000
" &>/dev/null &
